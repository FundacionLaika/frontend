{"ast":null,"code":"var _jsxFileName = \"/home/agus/Desktop/PROJECTS/LAIKA/frontend/src/Components/MenuUsuario/Subcomponents/UserInfo.js\";\nimport React, { useState, useEffect } from \"react\";\nimport FotoUsuario from \"./FotoUsuario\";\nimport \"../Styles/UsuarioGeneral.css\";\nimport { validationUserInfo } from \"../Functions/validationUserInfo\";\nimport AlertTitle from \"@material-ui/lab/AlertTitle\";\nimport Collapse from \"@material-ui/core/Collapse\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport api from \"../../SharedComponents/APIConfig\";\n\nasync function fetchUser(ID_Usuario) {\n  var response = await fetch(api.url + \"/usuario\", {\n    method: \"post\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      ID_Usuario\n    })\n  });\n  if (response.status !== 200) return null;\n  var json = await response.json();\n  return json;\n}\n\nasync function updateUser(ID_Usuario, state) {\n  var response = await fetch(api.url + \"/usuario\", {\n    method: \"put\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      ID_Usuario,\n      ...state\n    })\n  });\n  return response.status;\n}\n\nfunction UserInfo(props) {\n  const [state, setState] = useState({\n    nombre: \"\",\n    apellidos: \"\",\n    correo: \"\",\n    telefono: \"\",\n    rol: \"\",\n    foto: null\n  });\n  useEffect(() => {\n    async function fetchData() {\n      const userData = await fetchUser(props.ID_Usuario);\n      if (!userData) return;\n      var foto = null;\n\n      if (userData && userData.Foto) {\n        var buffer = Buffer.from(userData.Foto.data);\n        foto = buffer.toString(\"utf8\");\n      }\n\n      setState({\n        nombre: userData.Nombre,\n        apellidos: userData.Apellidos,\n        correo: userData.Correo,\n        telefono: userData.Telefono,\n        rol: userData.Rol,\n        foto: foto\n      });\n    }\n\n    fetchData();\n  }, [props]);\n  const [openError, setOpenError] = React.useState(false);\n  const [openSuccess, setOpenSuccess] = React.useState(false);\n  const [message, setMsg] = React.useState(\"\");\n\n  function onChange(event) {\n    setState({ ...state,\n      [event.target.name]: event.target.value\n    });\n  }\n\n  function imageHandler(event) {\n    try {\n      const reader = new FileReader();\n      const foto = event.target.id;\n\n      reader.onload = () => {\n        if (reader.readyState === 2) {\n          setState({ ...state,\n            [foto]: reader.result\n          });\n        }\n      };\n\n      reader.readAsDataURL(event.target.files[0]);\n    } catch (error) {}\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"datosGeneralesUsuario\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(Collapse, {\n    in: openError,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Alert, {\n    onClose: () => {\n      setOpenError(false);\n    },\n    variant: \"outlined\",\n    severity: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(AlertTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 6\n    }\n  }, \"Error - Faltan llenar los siguientes campos\"), message)), /*#__PURE__*/React.createElement(Collapse, {\n    in: openSuccess,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Alert, {\n    onClose: () => {\n      setOpenSuccess(false);\n    },\n    variant: \"outlined\",\n    severity: \"success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(AlertTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 6\n    }\n  }, \" Datos guardados exitosamente.\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockGeneralFoto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockFoto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(FotoUsuario, {\n    id: \"foto\",\n    imageHandler: imageHandler,\n    foto: state.foto,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 6\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockLabel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 6\n    }\n  }, \" Nombre: \", /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 22\n    }\n  }, \" \", state.nombre, \" \"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockLabel2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 6\n    }\n  }, \"Rol: \", /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 18\n    }\n  }, \" \", state.rol, \" \"), \" \"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockGeneral\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockDatosUsuario\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"nombreUsuario\",\n    className: \"inp\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    autoComplete: \"off\",\n    id: \"nombreUsuario\",\n    type: \"text\",\n    name: \"nombre\",\n    value: state.nombre,\n    onChange: onChange,\n    placeholder: \"\\xA0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 7\n    }\n  }, \"Nombre\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"focus-bg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockDatosUsuario2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"appellidosUsuario\",\n    className: \"inp\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    autoComplete: \"off\",\n    id: \"apellidosUsuario\",\n    type: \"text\",\n    name: \"apellidos\",\n    value: state.apellidos,\n    onChange: onChange,\n    placeholder: \"\\xA0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 7\n    }\n  }, \"Apellidos\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"focus-bg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 7\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockGeneral\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockDatosUsuario\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"correoUsuario\",\n    className: \"inp\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    autoComplete: \"off\",\n    id: \"correoUsuario\",\n    type: \"text\",\n    name: \"correo\",\n    value: state.correo,\n    onChange: onChange,\n    placeholder: \"\\xA0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 7\n    }\n  }, \"Correo electr\\xF3nico\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"focus-bg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockDatosUsuario2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"telUsuario\",\n    className: \"inp\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    autoComplete: \"off\",\n    id: \"telUsuario\",\n    type: \"text\",\n    name: \"telefono\",\n    value: state.telefono,\n    onChange: onChange,\n    placeholder: \"\\xA0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 7\n    }\n  }, \"T\\xE9lefono\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"focus-bg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockGuardarUsuario\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    autoComplete: \"off\",\n    className: \"btnGuardarUsuario\",\n    type: \"button\",\n    value: \"Guardar\",\n    onClick: async () => {\n      const valid = validationUserInfo(state);\n\n      if (valid.isValid) {\n        const status = await updateUser(props.ID_Usuario, state);\n\n        if (status === 200) {\n          setOpenError(false);\n          setOpenSuccess(true);\n        } else {\n          valid.msg = \"No se ha podido actualizar el usuario. Error en el servidor.\";\n          setMsg(valid.msg);\n          setOpenSuccess(false);\n          setOpenError(true);\n        }\n      } else {\n        setMsg(valid.msg);\n        setOpenSuccess(false);\n        setOpenError(true);\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 5\n    }\n  })));\n}\n\nexport default UserInfo;","map":{"version":3,"sources":["/home/agus/Desktop/PROJECTS/LAIKA/frontend/src/Components/MenuUsuario/Subcomponents/UserInfo.js"],"names":["React","useState","useEffect","FotoUsuario","validationUserInfo","AlertTitle","Collapse","Alert","api","fetchUser","ID_Usuario","response","fetch","url","method","headers","body","JSON","stringify","status","json","updateUser","state","UserInfo","props","setState","nombre","apellidos","correo","telefono","rol","foto","fetchData","userData","Foto","buffer","Buffer","from","data","toString","Nombre","Apellidos","Correo","Telefono","Rol","openError","setOpenError","openSuccess","setOpenSuccess","message","setMsg","onChange","event","target","name","value","imageHandler","reader","FileReader","id","onload","readyState","result","readAsDataURL","files","error","valid","isValid","msg"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport FotoUsuario from \"./FotoUsuario\";\nimport \"../Styles/UsuarioGeneral.css\";\nimport { validationUserInfo } from \"../Functions/validationUserInfo\";\nimport AlertTitle from \"@material-ui/lab/AlertTitle\";\nimport Collapse from \"@material-ui/core/Collapse\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport api from \"../../SharedComponents/APIConfig\";\n\n\nasync function fetchUser(ID_Usuario) {\n\t\tvar response = await fetch(api.url+\"/usuario\", {\n\t\t\tmethod: \"post\",\n\t\t\theaders: { \"Content-Type\": \"application/json\" },\n\t\t\tbody: JSON.stringify({ ID_Usuario }),\n\t\t});\n\n\tif (response.status !== 200) return null;\n\tvar json = await response.json();\n\n\treturn json;\n}\n\nasync function updateUser(ID_Usuario, state) {\n\tvar response = await fetch(api.url+\"/usuario\", {\n\t\tmethod: \"put\",\n\t\theaders: { \"Content-Type\": \"application/json\" },\n\t\tbody: JSON.stringify({ ID_Usuario, ...state }),\n\t});\n\n\treturn response.status;\n}\n\nfunction UserInfo(props) {\n\tconst [state, setState] = useState({\n\t\tnombre: \"\",\n\t\tapellidos: \"\",\n\t\tcorreo: \"\",\n\t\ttelefono: \"\",\n\t\trol: \"\",\n\t\tfoto: null,\n\t});\n\n\tuseEffect(() => {\n\t\tasync function fetchData() {\n\t\t\tconst userData = await fetchUser(props.ID_Usuario);\n\t\t\tif (!userData) return;\n\n\t\t\tvar foto = null;\n\t\t\tif (userData && userData.Foto) {\n\t\t\t\tvar buffer = Buffer.from(userData.Foto.data);\n\t\t\t\tfoto = buffer.toString(\"utf8\");\n\t\t\t}\n\n\t\t\tsetState({\n\t\t\t\tnombre: userData.Nombre,\n\t\t\t\tapellidos: userData.Apellidos,\n\t\t\t\tcorreo: userData.Correo,\n\t\t\t\ttelefono: userData.Telefono,\n\t\t\t\trol: userData.Rol,\n\t\t\t\tfoto: foto,\n\t\t\t});\n\t\t}\n\t\tfetchData();\n\t}, [props]);\n\n\tconst [openError, setOpenError] = React.useState(false);\n\tconst [openSuccess, setOpenSuccess] = React.useState(false);\n\tconst [message, setMsg] = React.useState(\"\");\n\n\tfunction onChange(event) {\n\t\tsetState({\n\t\t\t...state,\n\t\t\t[event.target.name]: event.target.value,\n\t\t});\n\t}\n\n\tfunction imageHandler(event) {\n\t\ttry {\n\t\t\tconst reader = new FileReader();\n\t\t\tconst foto = event.target.id;\n\n\t\t\treader.onload = () => {\n\t\t\t\tif (reader.readyState === 2) {\n\t\t\t\t\tsetState({ ...state, [foto]: reader.result });\n\t\t\t\t}\n\t\t\t};\n\t\t\treader.readAsDataURL(event.target.files[0]);\n\t\t} catch (error) {}\n\t}\n\n\treturn (\n\t\t<div className=\"datosGeneralesUsuario\">\n\t\t\t<Collapse in={openError}>\n\t\t\t\t<Alert\n\t\t\t\t\tonClose={() => {\n\t\t\t\t\t\tsetOpenError(false);\n\t\t\t\t\t}}\n\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\tseverity=\"error\"\n\t\t\t\t>\n\t\t\t\t\t<AlertTitle>\n\t\t\t\t\t\tError - Faltan llenar los siguientes campos\n\t\t\t\t\t</AlertTitle>\n\t\t\t\t\t{message}\n\t\t\t\t</Alert>\n\t\t\t</Collapse>\n\n\t\t\t<Collapse in={openSuccess}>\n\t\t\t\t<Alert\n\t\t\t\t\tonClose={() => {\n\t\t\t\t\t\tsetOpenSuccess(false);\n\t\t\t\t\t}}\n\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\tseverity=\"success\"\n\t\t\t\t>\n\t\t\t\t\t<AlertTitle> Datos guardados exitosamente.</AlertTitle>\n\t\t\t\t</Alert>\n\t\t\t</Collapse>\n\n\t\t\t<div className=\"blockGeneralFoto\">\n\t\t\t\t<div className=\"blockFoto\">\n\t\t\t\t\t<FotoUsuario\n\t\t\t\t\t\tid=\"foto\"\n\t\t\t\t\t\timageHandler={imageHandler}\n\t\t\t\t\t\tfoto={state.foto}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"blockLabel\">\n\t\t\t\t\t<label> Nombre: <span> {state.nombre} </span></label>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"blockLabel2\">\n\t\t\t\t\t<label>Rol: <span> {state.rol} </span> </label>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div className=\"blockGeneral\">\n\t\t\t\t<div className=\"blockDatosUsuario\">\n\t\t\t\t\t<label htmlFor=\"nombreUsuario\" className=\"inp\">\n\t\t\t\t\t\t<input autoComplete=\"off\"\n\t\t\t\t\t\t\tid=\"nombreUsuario\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tname=\"nombre\"\n\t\t\t\t\t\t\tvalue={state.nombre}\n\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\tplaceholder=\"&nbsp;\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span className=\"label\">Nombre</span>\n\t\t\t\t\t\t<span className=\"focus-bg\"></span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"blockDatosUsuario2\">\n\t\t\t\t\t<label htmlFor=\"appellidosUsuario\" className=\"inp\">\n\t\t\t\t\t\t<input autoComplete=\"off\"\n\t\t\t\t\t\t\tid=\"apellidosUsuario\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tname=\"apellidos\"\n\t\t\t\t\t\t\tvalue={state.apellidos}\n\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\tplaceholder=\"&nbsp;\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span className=\"label\">Apellidos</span>\n\t\t\t\t\t\t<span className=\"focus-bg\"></span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div className=\"blockGeneral\">\n\t\t\t\t<div className=\"blockDatosUsuario\">\n\t\t\t\t\t<label htmlFor=\"correoUsuario\" className=\"inp\">\n\t\t\t\t\t\t<input autoComplete=\"off\"\n\t\t\t\t\t\t\tid=\"correoUsuario\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tname=\"correo\"\n\t\t\t\t\t\t\tvalue={state.correo}\n\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\tplaceholder=\"&nbsp;\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span className=\"label\">Correo electrónico</span>\n\t\t\t\t\t\t<span className=\"focus-bg\"></span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"blockDatosUsuario2\">\n\t\t\t\t\t<label htmlFor=\"telUsuario\" className=\"inp\">\n\t\t\t\t\t\t<input autoComplete=\"off\"\n\t\t\t\t\t\t\tid=\"telUsuario\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tname=\"telefono\"\n\t\t\t\t\t\t\tvalue={state.telefono}\n\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\tplaceholder=\"&nbsp;\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span className=\"label\">Télefono</span>\n\t\t\t\t\t\t<span className=\"focus-bg\"></span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"blockGuardarUsuario\">\n\t\t\t\t<input autoComplete=\"off\"\n\t\t\t\t\tclassName=\"btnGuardarUsuario\"\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tvalue=\"Guardar\"\n\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\tconst valid = validationUserInfo(state);\n\t\t\t\t\t\tif (valid.isValid) {\n\t\t\t\t\t\t\tconst status = await updateUser(\n\t\t\t\t\t\t\t\tprops.ID_Usuario,\n\t\t\t\t\t\t\t\tstate\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (status === 200) {\n\t\t\t\t\t\t\t\tsetOpenError(false);\n\t\t\t\t\t\t\t\tsetOpenSuccess(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvalid.msg =\n\t\t\t\t\t\t\t\t\t\"No se ha podido actualizar el usuario. Error en el servidor.\";\n\t\t\t\t\t\t\t\tsetMsg(valid.msg);\n\t\t\t\t\t\t\t\tsetOpenSuccess(false);\n\t\t\t\t\t\t\t\tsetOpenError(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetMsg(valid.msg);\n\t\t\t\t\t\t\tsetOpenSuccess(false);\n\t\t\t\t\t\t\tsetOpenError(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default UserInfo;\n"]},"metadata":{},"sourceType":"module"}