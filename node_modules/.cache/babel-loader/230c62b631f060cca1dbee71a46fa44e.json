{"ast":null,"code":"var _jsxFileName = \"/home/agus/Desktop/PROJECTS/LAIKA/frontend/src/Components/MenuUsuario/Subcomponents/UserInfo.js\";\nimport React, { useState, useEffect } from \"react\";\nimport FotoUsuario from \"./FotoUsuario\";\nimport \"../Styles/UsuarioGeneral.css\";\nimport { validationUserInfo } from \"../Functions/validationUserInfo\";\nimport AlertTitle from \"@material-ui/lab/AlertTitle\";\nimport Collapse from \"@material-ui/core/Collapse\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport api from \"../../SharedComponents/APIConfig\";\n\nasync function fetchUser(ID_Usuario) {\n  var response = await fetch(api.url + \"/usuario\", {\n    method: \"post\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      ID_Usuario\n    })\n  });\n  if (response.status !== 200) return null;\n  var json = await response.json();\n  return json;\n}\n\nasync function updateUser(ID_Usuario, state) {\n  var response = await fetch(api.url + \"/usuario\", {\n    method: \"put\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      ID_Usuario,\n      ...state\n    })\n  });\n  return response.status;\n}\n\nfunction UserInfo(props) {\n  const [state, setState] = useState({\n    nombre: \"\",\n    apellidos: \"\",\n    correo: \"\",\n    telefono: \"\",\n    rol: \"\",\n    foto: null\n  });\n  useEffect(() => {\n    async function fetchData() {\n      const userData = await fetchUser(props.ID_Usuario);\n      if (!userData) return;\n      var foto = null;\n\n      if (userData && userData.Foto) {\n        var buffer = Buffer.from(userData.Foto.data);\n        foto = buffer.toString(\"utf8\");\n      }\n\n      setState({\n        nombre: userData.Nombre,\n        apellidos: userData.Apellidos,\n        correo: userData.Correo,\n        telefono: userData.Telefono,\n        rol: userData.Rol,\n        foto: foto\n      });\n    }\n\n    fetchData();\n  }, [props]);\n  const [openError, setOpenError] = React.useState(false);\n  const [openSuccess, setOpenSuccess] = React.useState(false);\n  const [message, setMsg] = React.useState(\"\");\n\n  function onChange(event) {\n    setState({ ...state,\n      [event.target.name]: event.target.value\n    });\n  }\n\n  function imageHandler(event) {\n    try {\n      const reader = new FileReader();\n      const foto = event.target.id;\n\n      reader.onload = () => {\n        if (reader.readyState === 2) {\n          setState({ ...state,\n            [foto]: reader.result\n          });\n        }\n      };\n\n      reader.readAsDataURL(event.target.files[0]);\n    } catch (error) {}\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"datosGeneralesUsuario\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Collapse, {\n    in: openError,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Alert, {\n    onClose: () => {\n      setOpenError(false);\n    },\n    variant: \"outlined\",\n    severity: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(AlertTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 21\n    }\n  }, \"Error - Faltan llenar los siguientes campos\"), message)), /*#__PURE__*/React.createElement(Collapse, {\n    in: openSuccess,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Alert, {\n    onClose: () => {\n      setOpenSuccess(false);\n    },\n    variant: \"outlined\",\n    severity: \"success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(AlertTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 21\n    }\n  }, \" Datos guardados exitosamente.\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockGeneralFoto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockFoto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(FotoUsuario, {\n    id: \"foto\",\n    imageHandler: imageHandler,\n    foto: state.foto,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockLabel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 21\n    }\n  }, \" \", \"Nombre: \", /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 33\n    }\n  }, \" \", state.nombre, \" \"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockLabel2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 21\n    }\n  }, \"Rol: \", /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 30\n    }\n  }, \" \", state.rol, \" \"), \" \"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockGeneral\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockDatosUsuario\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"nombreUsuario\",\n    className: \"inp\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    autoComplete: \"off\",\n    id: \"nombreUsuario\",\n    type: \"text\",\n    name: \"nombre\",\n    value: state.nombre,\n    onChange: onChange,\n    placeholder: \"\\xA0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 25\n    }\n  }, \"Nombre\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"focus-bg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockDatosUsuario2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"appellidosUsuario\",\n    className: \"inp\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    autoComplete: \"off\",\n    id: \"apellidosUsuario\",\n    type: \"text\",\n    name: \"apellidos\",\n    value: state.apellidos,\n    onChange: onChange,\n    placeholder: \"\\xA0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 25\n    }\n  }, \"Apellidos\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"focus-bg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 25\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockGeneral\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockDatosUsuario\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"correoUsuario\",\n    className: \"inp\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    autoComplete: \"off\",\n    id: \"correoUsuario\",\n    type: \"text\",\n    name: \"correo\",\n    value: state.correo,\n    onChange: onChange,\n    placeholder: \"\\xA0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 25\n    }\n  }, \"Correo electr\\xF3nico\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"focus-bg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockDatosUsuario2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"telUsuario\",\n    className: \"inp\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    autoComplete: \"off\",\n    id: \"telUsuario\",\n    type: \"text\",\n    name: \"telefono\",\n    value: state.telefono,\n    onChange: onChange,\n    placeholder: \"\\xA0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 25\n    }\n  }, \"T\\xE9lefono\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"focus-bg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 25\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"blockGuardarUsuario\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    autoComplete: \"off\",\n    className: \"btnGuardarUsuario\",\n    type: \"button\",\n    value: \"Guardar\",\n    onClick: async () => {\n      const valid = validationUserInfo(state);\n\n      if (valid.isValid) {\n        const status = await updateUser(props.ID_Usuario, state);\n\n        if (status === 200) {\n          setOpenError(false);\n          setOpenSuccess(true);\n        } else {\n          valid.msg = \"No se ha podido actualizar el usuario. Error en el servidor.\";\n          setMsg(valid.msg);\n          setOpenSuccess(false);\n          setOpenError(true);\n        }\n      } else {\n        setMsg(valid.msg);\n        setOpenSuccess(false);\n        setOpenError(true);\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 17\n    }\n  })));\n}\n\nexport default UserInfo;","map":{"version":3,"sources":["/home/agus/Desktop/PROJECTS/LAIKA/frontend/src/Components/MenuUsuario/Subcomponents/UserInfo.js"],"names":["React","useState","useEffect","FotoUsuario","validationUserInfo","AlertTitle","Collapse","Alert","api","fetchUser","ID_Usuario","response","fetch","url","method","headers","body","JSON","stringify","status","json","updateUser","state","UserInfo","props","setState","nombre","apellidos","correo","telefono","rol","foto","fetchData","userData","Foto","buffer","Buffer","from","data","toString","Nombre","Apellidos","Correo","Telefono","Rol","openError","setOpenError","openSuccess","setOpenSuccess","message","setMsg","onChange","event","target","name","value","imageHandler","reader","FileReader","id","onload","readyState","result","readAsDataURL","files","error","valid","isValid","msg"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport FotoUsuario from \"./FotoUsuario\";\nimport \"../Styles/UsuarioGeneral.css\";\nimport { validationUserInfo } from \"../Functions/validationUserInfo\";\nimport AlertTitle from \"@material-ui/lab/AlertTitle\";\nimport Collapse from \"@material-ui/core/Collapse\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport api from \"../../SharedComponents/APIConfig\";\n\nasync function fetchUser(ID_Usuario) {\n    var response = await fetch(api.url + \"/usuario\", {\n        method: \"post\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ ID_Usuario }),\n    });\n\n    if (response.status !== 200) return null;\n    var json = await response.json();\n\n    return json;\n}\n\nasync function updateUser(ID_Usuario, state) {\n    var response = await fetch(api.url + \"/usuario\", {\n        method: \"put\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ ID_Usuario, ...state }),\n    });\n\n    return response.status;\n}\n\nfunction UserInfo(props) {\n    const [state, setState] = useState({\n        nombre: \"\",\n        apellidos: \"\",\n        correo: \"\",\n        telefono: \"\",\n        rol: \"\",\n        foto: null,\n    });\n\n    useEffect(() => {\n        async function fetchData() {\n            const userData = await fetchUser(props.ID_Usuario);\n            if (!userData) return;\n\n            var foto = null;\n            if (userData && userData.Foto) {\n                var buffer = Buffer.from(userData.Foto.data);\n                foto = buffer.toString(\"utf8\");\n            }\n\n            setState({\n                nombre: userData.Nombre,\n                apellidos: userData.Apellidos,\n                correo: userData.Correo,\n                telefono: userData.Telefono,\n                rol: userData.Rol,\n                foto: foto,\n            });\n        }\n        fetchData();\n    }, [props]);\n\n    const [openError, setOpenError] = React.useState(false);\n    const [openSuccess, setOpenSuccess] = React.useState(false);\n    const [message, setMsg] = React.useState(\"\");\n\n    function onChange(event) {\n        setState({\n            ...state,\n            [event.target.name]: event.target.value,\n        });\n    }\n\n    function imageHandler(event) {\n        try {\n            const reader = new FileReader();\n            const foto = event.target.id;\n\n            reader.onload = () => {\n                if (reader.readyState === 2) {\n                    setState({ ...state, [foto]: reader.result });\n                }\n            };\n            reader.readAsDataURL(event.target.files[0]);\n        } catch (error) {}\n    }\n\n    return (\n        <div className=\"datosGeneralesUsuario\">\n            <Collapse in={openError}>\n                <Alert\n                    onClose={() => {\n                        setOpenError(false);\n                    }}\n                    variant=\"outlined\"\n                    severity=\"error\"\n                >\n                    <AlertTitle>\n                        Error - Faltan llenar los siguientes campos\n                    </AlertTitle>\n                    {message}\n                </Alert>\n            </Collapse>\n\n            <Collapse in={openSuccess}>\n                <Alert\n                    onClose={() => {\n                        setOpenSuccess(false);\n                    }}\n                    variant=\"outlined\"\n                    severity=\"success\"\n                >\n                    <AlertTitle> Datos guardados exitosamente.</AlertTitle>\n                </Alert>\n            </Collapse>\n\n            <div className=\"blockGeneralFoto\">\n                <div className=\"blockFoto\">\n                    <FotoUsuario\n                        id=\"foto\"\n                        imageHandler={imageHandler}\n                        foto={state.foto}\n                    />\n                </div>\n                <div className=\"blockLabel\">\n                    <label>\n                        {\" \"}\n                        Nombre: <span> {state.nombre} </span>\n                    </label>\n                </div>\n                <div className=\"blockLabel2\">\n                    <label>\n                        Rol: <span> {state.rol} </span>{\" \"}\n                    </label>\n                </div>\n            </div>\n\n            <div className=\"blockGeneral\">\n                <div className=\"blockDatosUsuario\">\n                    <label htmlFor=\"nombreUsuario\" className=\"inp\">\n                        <input\n                            autoComplete=\"off\"\n                            id=\"nombreUsuario\"\n                            type=\"text\"\n                            name=\"nombre\"\n                            value={state.nombre}\n                            onChange={onChange}\n                            placeholder=\"&nbsp;\"\n                        />\n                        <span className=\"label\">Nombre</span>\n                        <span className=\"focus-bg\"></span>\n                    </label>\n                </div>\n                <div className=\"blockDatosUsuario2\">\n                    <label htmlFor=\"appellidosUsuario\" className=\"inp\">\n                        <input\n                            autoComplete=\"off\"\n                            id=\"apellidosUsuario\"\n                            type=\"text\"\n                            name=\"apellidos\"\n                            value={state.apellidos}\n                            onChange={onChange}\n                            placeholder=\"&nbsp;\"\n                        />\n                        <span className=\"label\">Apellidos</span>\n                        <span className=\"focus-bg\"></span>\n                    </label>\n                </div>\n            </div>\n\n            <div className=\"blockGeneral\">\n                <div className=\"blockDatosUsuario\">\n                    <label htmlFor=\"correoUsuario\" className=\"inp\">\n                        <input\n                            autoComplete=\"off\"\n                            id=\"correoUsuario\"\n                            type=\"text\"\n                            name=\"correo\"\n                            value={state.correo}\n                            onChange={onChange}\n                            placeholder=\"&nbsp;\"\n                        />\n                        <span className=\"label\">Correo electrónico</span>\n                        <span className=\"focus-bg\"></span>\n                    </label>\n                </div>\n                <div className=\"blockDatosUsuario2\">\n                    <label htmlFor=\"telUsuario\" className=\"inp\">\n                        <input\n                            autoComplete=\"off\"\n                            id=\"telUsuario\"\n                            type=\"text\"\n                            name=\"telefono\"\n                            value={state.telefono}\n                            onChange={onChange}\n                            placeholder=\"&nbsp;\"\n                        />\n                        <span className=\"label\">Télefono</span>\n                        <span className=\"focus-bg\"></span>\n                    </label>\n                </div>\n            </div>\n            <div className=\"blockGuardarUsuario\">\n                <input\n                    autoComplete=\"off\"\n                    className=\"btnGuardarUsuario\"\n                    type=\"button\"\n                    value=\"Guardar\"\n                    onClick={async () => {\n                        const valid = validationUserInfo(state);\n                        if (valid.isValid) {\n                            const status = await updateUser(\n                                props.ID_Usuario,\n                                state\n                            );\n                            if (status === 200) {\n                                setOpenError(false);\n                                setOpenSuccess(true);\n                            } else {\n                                valid.msg =\n                                    \"No se ha podido actualizar el usuario. Error en el servidor.\";\n                                setMsg(valid.msg);\n                                setOpenSuccess(false);\n                                setOpenError(true);\n                            }\n                        } else {\n                            setMsg(valid.msg);\n                            setOpenSuccess(false);\n                            setOpenError(true);\n                        }\n                    }}\n                />\n            </div>\n        </div>\n    );\n}\n\nexport default UserInfo;\n"]},"metadata":{},"sourceType":"module"}